<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Kalender Pengajian Majelis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --primary: #10b981;
      --primary-dark: #059669;
      --primary-light: #d1fae5;
      --secondary: #8b5cf6;
      --bg: #f8fafc;
      --surface: #ffffff;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --text-tertiary: #94a3b8;
      --border: #e2e8f0;
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.06);
      --shadow-lg: 0 10px 25px rgba(0,0,0,0.08);
      --transition: all 0.2s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Inter", system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #f0f9ff 0%, #f8fafc 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
      color: var(--text-primary);
    }

    .app {
      width: 100%;
      max-width: 460px;
      background: var(--surface);
      border-radius: var(--radius-xl);
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      position: relative;
    }

    /* ---------- HEADER ---------- */
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      padding: 24px;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 120px;
      height: 120px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 50%;
      transform: translate(30%, -30%);
    }

    .header-content {
      position: relative;
      z-index: 2;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 20px;
    }

    .greeting h1 {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 4px;
      letter-spacing: -0.01em;
    }

    .greeting p {
      font-size: 0.875rem;
      opacity: 0.9;
      font-weight: 400;
    }

    .logo {
      width: 52px;
      height: 52px;
      border-radius: var(--radius-lg);
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1.5px solid rgba(255, 255, 255, 0.25);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      font-weight: 700;
      text-align: center;
      line-height: 1.2;
      padding: 8px;
    }

    .search-container {
      position: relative;
      margin-top: 8px;
    }

    .search-box {
      width: 100%;
      padding: 14px 18px 14px 46px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1.5px solid rgba(255, 255, 255, 0.25);
      border-radius: var(--radius-full);
      color: white;
      font-size: 0.875rem;
      font-weight: 500;
      transition: var(--transition);
    }

    .search-box:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .search-box::placeholder {
      color: rgba(255, 255, 255, 0.8);
    }

    .search-icon {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      font-size: 0.9rem;
    }

    /* ---------- CONTENT ---------- */
    .content {
      padding: 28px 24px;
    }

    .section-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 20px;
      letter-spacing: -0.01em;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    /* ---------- CALENDAR ---------- */
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .current-month {
      font-size: 1.375rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .nav-buttons {
      display: flex;
      gap: 8px;
    }

    .nav-btn {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      border: 1.5px solid var(--border);
      background: var(--surface);
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      font-size: 0.875rem;
    }

    .nav-btn:hover {
      background: var(--bg);
      border-color: var(--primary);
      color: var(--primary);
    }

    .weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      margin-bottom: 12px;
      text-align: center;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      margin-bottom: 28px;
    }

    .day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-full);
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
    }

    .day:hover {
      background: var(--primary-light);
      color: var(--primary-dark);
    }

    .day.empty {
      cursor: default;
      background: transparent !important;
    }

    .day.today {
      background: var(--primary-light);
      color: var(--primary-dark);
      font-weight: 700;
      border: 1.5px solid var(--primary);
    }

    .day.event {
      background: var(--primary);
      color: white;
      font-weight: 700;
      box-shadow: var(--shadow-sm);
    }

    .day.event:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .day.selected {
      background: var(--primary-dark);
      color: white;
      transform: scale(1.05);
      box-shadow: var(--shadow-md);
    }

    .day.selected:hover {
      background: var(--primary-dark);
    }

    .event-dot {
      position: absolute;
      bottom: 4px;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: var(--secondary);
    }

    .day.event .event-dot {
      background: white;
    }

    /* ---------- MONTH SELECTOR ---------- */
    .month-selector {
      background: var(--bg);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin-bottom: 28px;
    }

    .year-label {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 12px;
      display: block;
    }

    .month-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 8px;
    }

    .month-btn {
      padding: 10px 4px;
      border: none;
      background: var(--surface);
      border-radius: var(--radius-md);
      font-size: 0.8125rem;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: var(--transition);
      border: 1.5px solid transparent;
    }

    .month-btn:hover {
      background: var(--primary-light);
      color: var(--primary-dark);
      border-color: var(--primary);
    }

    .month-btn.active {
      background: var(--primary);
      color: white;
      font-weight: 600;
      border-color: var(--primary);
    }

    /* ---------- EVENT DETAIL ---------- */
    .event-section {
      background: var(--bg);
      border-radius: var(--radius-lg);
      padding: 24px;
    }

    .event-hint {
      font-size: 0.8125rem;
      color: var(--text-tertiary);
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .event-detail {
      min-height: 120px;
    }

    .no-selection {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 30px 20px;
      color: var(--text-tertiary);
    }

    .no-selection i {
      font-size: 2rem;
      margin-bottom: 12px;
      opacity: 0.5;
    }

    .no-selection p {
      font-size: 0.875rem;
      font-weight: 500;
    }

    .event-date {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }

    .event-card {
      background: white;
      border-radius: var(--radius-lg);
      padding: 18px;
      margin-bottom: 12px;
      border-left: 4px solid var(--primary);
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }

    .event-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .event-title {
      font-size: 0.9375rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 6px;
    }

    .event-desc {
      font-size: 0.8125rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    .event-time {
      display: inline-block;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--primary);
      background: var(--primary-light);
      padding: 4px 10px;
      border-radius: var(--radius-full);
      margin-top: 10px;
    }

    /* ---------- RESPONSIVE ---------- */
    @media (max-width: 480px) {
      body {
        padding: 16px;
      }
      
      .app {
        border-radius: var(--radius-lg);
      }
      
      .header, .content {
        padding: 20px;
      }
      
      .section-title {
        font-size: 1.125rem;
      }
      
      .current-month {
        font-size: 1.25rem;
      }
      
      .month-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="greeting">
          <h1>Halo, Jamaah!</h1>
          <p>Jadwal pengajian Majelis Asmaul Husna</p>
        </div>
        <div class="logo">
          MA<br>H
        </div>
      </div>
      
      <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input type="text" class="search-box" id="searchInput" placeholder="Cari kajian atau tema..." />
      </div>
    </header>

    <!-- Content -->
    <main class="content">
      <!-- Calendar -->
      <section>
        <div class="calendar-header">
          <h2 id="monthTitle" class="current-month">Januari 2026</h2>
          <div class="nav-buttons">
            <button class="nav-btn" id="prevMonth">
              <i class="fas fa-chevron-left"></i>
            </button>
            <button class="nav-btn" id="todayBtn">Hari Ini</button>
            <button class="nav-btn" id="nextMonth">
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </div>

        <div class="weekdays">
          <span>Sen</span>
          <span>Sel</span>
          <span>Rab</span>
          <span>Kam</span>
          <span>Jum</span>
          <span>Sab</span>
          <span>Min</span>
        </div>

        <div id="calendarGrid" class="calendar"></div>
      </section>

      <!-- Month selector -->
      <section class="month-selector">
        <span id="yearLabel" class="year-label"></span>
        <div class="month-grid" id="monthPills"></div>
      </section>

      <!-- Event detail -->
      <section class="event-section">
        <h2 class="section-title">
          Detail Pengajian
          <span id="eventCount" style="font-size: 0.875rem; color: var(--text-tertiary); font-weight: 500;">0 jadwal</span>
        </h2>
        <p class="event-hint" id="eventHint">
          Pilih tanggal yang berwarna hijau untuk melihat detail jadwal pengajian.
        </p>
        <div class="event-detail" id="eventDetailBox">
          <div class="no-selection">
            <i class="far fa-calendar-alt"></i>
            <p>Belum ada tanggal yang dipilih</p>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // ---------------- CONFIG ----------------
    const monthNames = [
      "Januari","Februari","Maret","April","Mei","Juni",
      "Juli","Agustus","September","Oktober","November","Desember"
    ];

    const shortMonthNames = ["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"];
    
    const dayNames = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];

    const EVENT_TYPES = {
      tuesday: {
        title: "PENGAJIAN RUTIN MALAM RABU",
        desc: "Pembacaan dzikir Ratibul Attas & Asmaul Husna (Ba'da Magrib s/d Isya)",
        time: "Ba'da Magrib - Isya",
        icon: "fas fa-book-quran"
      },
      friday: {
        title: "PENGAJIAN RUTIN MALAM SABTU",
        desc: "Pembacaan Maulid Simthudduror",
        time: "20:00 - 21:30 WIB",
        icon: "fas fa-mosque"
      },
      saturdayBiweekly: {
        title: "KAJIAN RUTIN MAJELIS ASMAUL HUSNA",
        desc: "Kajian rutin di Musholla Al-Muhajirin",
        time: "Ba'da Magrib - Isya",
        icon: "fas fa-users"
      }
    };

    // DOM Elements
    const monthTitle   = document.getElementById("monthTitle");
    const yearLabel    = document.getElementById("yearLabel");
    const calendarGrid = document.getElementById("calendarGrid");
    const monthPills   = document.getElementById("monthPills");
    const eventDetailBox = document.getElementById("eventDetailBox");
    const searchInput  = document.getElementById("searchInput");
    const prevMonthBtn = document.getElementById("prevMonth");
    const nextMonthBtn = document.getElementById("nextMonth");
    const todayBtn     = document.getElementById("todayBtn");
    const eventCount   = document.getElementById("eventCount");

    // State
    let currentDate  = new Date();
    let currentMonth = currentDate.getMonth();
    let currentYear  = currentDate.getFullYear();

    let eventsThisMonth = [];
    let eventMapByDay   = {};
    let selectedDay     = null;

    // ---------------- GENERATE EVENTS ----------------
    function generateEventsForMonth(year, month) {
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const events = [];

      // Cari Sabtu pertama untuk pola 2 minggu sekali
      let firstSaturdayDate = null;
      for (let d = 1; d <= 7; d++) {
        const date = new Date(year, month, d);
        if (date.getDay() === 6) { // Sabtu
          firstSaturdayDate = d;
          break;
        }
      }

      for (let day = 1; day <= daysInMonth; day++) {
        const date = new Date(year, month, day);
        const weekday = date.getDay();

        if (weekday === 2) { // Selasa
          events.push({ 
            date, 
            type: "tuesday", 
            ...EVENT_TYPES.tuesday,
            dateString: `${day}/${month + 1}/${year}`
          });
        }
        if (weekday === 5) { // Jumat
          events.push({ 
            date, 
            type: "friday", 
            ...EVENT_TYPES.friday,
            dateString: `${day}/${month + 1}/${year}`
          });
        }

        if (weekday === 6 && firstSaturdayDate !== null) { // Sabtu 2 minggu sekali
          if ((day - firstSaturdayDate) % 14 === 0) {
            events.push({ 
              date, 
              type: "saturdayBiweekly", 
              ...EVENT_TYPES.saturdayBiweekly,
              dateString: `${day}/${month + 1}/${year}`
            });
          }
        }
      }

      return events.sort((a, b) => a.date - b.date);
    }

    // ---------------- RENDER CALENDAR ----------------
    function renderCalendar(year, month, events) {
      calendarGrid.innerHTML = "";

      const firstDay = new Date(year, month, 1);
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      // Index Senin-based: Sen=0..Min=6
      const startIndex = (firstDay.getDay() + 6) % 7;

      const today = new Date();
      const isThisMonth = today.getFullYear() === year && today.getMonth() === month;

      // Map event by date
      eventMapByDay = {};
      events.forEach(ev => {
        const d = ev.date.getDate();
        if (!eventMapByDay[d]) eventMapByDay[d] = [];
        eventMapByDay[d].push(ev);
      });

      // Update event count
      eventCount.textContent = `${events.length} jadwal`;

      // Cell kosong sebelum tanggal 1
      for (let i = 0; i < startIndex; i++) {
        const cell = document.createElement("div");
        cell.className = "day empty";
        calendarGrid.appendChild(cell);
      }

      // Tanggal bulan ini
      for (let day = 1; day <= daysInMonth; day++) {
        const cell = document.createElement("div");
        cell.className = "day";
        cell.dataset.day = day;

        const hasEvent = !!eventMapByDay[day];
        const isToday = isThisMonth && day === today.getDate();
        const isSelected = selectedDay === day;

        if (hasEvent) {
          cell.classList.add("event");
          const eventDot = document.createElement("div");
          eventDot.className = "event-dot";
          cell.appendChild(eventDot);
        }

        if (isToday) {
          cell.classList.add("today");
        }

        if (isSelected) {
          cell.classList.add("selected");
        }

        cell.textContent = day;

        cell.addEventListener("click", () => {
          if (hasEvent) {
            selectedDay = day;
            renderCalendar(year, month, events); // Re-render untuk update selected state
            showEventsForDate(eventMapByDay[day][0].date, eventMapByDay[day]);
          }
        });

        calendarGrid.appendChild(cell);
      }

      monthTitle.textContent = `${monthNames[month]} ${year}`;
    }

    // ---------------- RENDER MONTH PILLS ----------------
    function renderMonthPills(year) {
      yearLabel.textContent = `Tahun ${year}`;
      monthPills.innerHTML = "";

      shortMonthNames.forEach((name, index) => {
        const btn = document.createElement("button");
        btn.className = "month-btn" + (index === currentMonth && currentYear === year ? " active" : "");
        btn.textContent = name;
        btn.dataset.month = index;
        btn.addEventListener("click", () => {
          currentMonth = index;
          renderAll();
        });
        monthPills.appendChild(btn);
      });
    }

    // ---------------- SHOW EVENTS FOR A DATE ----------------
    function showEventsForDate(dateObj, events) {
      const searchText = searchInput.value.trim().toLowerCase();

      const filtered = events.filter(ev => {
        if (!searchText) return true;
        const haystack = `${ev.title} ${ev.desc} ${ev.time}`.toLowerCase();
        return haystack.includes(searchText);
      });

      eventDetailBox.innerHTML = "";

      if (filtered.length === 0) {
        eventDetailBox.innerHTML = `
          <div class="no-selection">
            <i class="fas fa-search"></i>
            <p>Tidak ada jadwal yang cocok dengan pencarian pada tanggal ini.</p>
          </div>
        `;
        return;
      }

      const dateLabel = document.createElement("div");
      dateLabel.className = "event-date";
      const dayName = dayNames[dateObj.getDay()];
      dateLabel.textContent = `${dayName}, ${dateObj.getDate()} ${monthNames[dateObj.getMonth()]} ${dateObj.getFullYear()}`;
      eventDetailBox.appendChild(dateLabel);

      filtered.forEach(ev => {
        const card = document.createElement("div");
        card.className = "event-card";
        card.innerHTML = `
          <div class="event-title">
            <i class="${ev.icon}" style="margin-right: 8px; color: var(--primary);"></i>
            ${ev.title}
          </div>
          <div class="event-desc">${ev.desc}</div>
          <div class="event-time">${ev.time}</div>
        `;
        eventDetailBox.appendChild(card);
      });
    }

    // ---------------- NAVIGATION ----------------
    prevMonthBtn.addEventListener("click", () => {
      if (currentMonth === 0) {
        currentMonth = 11;
        currentYear--;
      } else {
        currentMonth--;
      }
      renderAll();
    });

    nextMonthBtn.addEventListener("click", () => {
      if (currentMonth === 11) {
        currentMonth = 0;
        currentYear++;
      } else {
        currentMonth++;
      }
      renderAll();
    });

    todayBtn.addEventListener("click", () => {
      const today = new Date();
      currentMonth = today.getMonth();
      currentYear = today.getFullYear();
      selectedDay = today.getDate();
      renderAll();
    });

    // ---------------- SEARCH ----------------
    searchInput.addEventListener("input", () => {
      if (!selectedDay) return;
      
      const events = eventMapByDay[selectedDay] || [];
      if (events.length > 0) {
        showEventsForDate(events[0].date, events);
      }
    });

    // ---------------- MAIN RENDER ----------------
    function renderAll() {
      renderMonthPills(currentYear);
      eventsThisMonth = generateEventsForMonth(currentYear, currentMonth);
      renderCalendar(currentYear, currentMonth, eventsThisMonth);

      // Reset detail box jika tidak ada tanggal terpilih
      if (!selectedDay) {
        eventDetailBox.innerHTML = `
          <div class="no-selection">
            <i class="far fa-calendar-alt"></i>
            <p>Belum ada tanggal yang dipilih</p>
          </div>
        `;
      }
    }

    // Initialize
    renderAll();
  </script>
</body>
</html>